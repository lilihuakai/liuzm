<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
        <template id="layout" inherit_id="website_myaccount_base.mobile_layout">
            <xpath expr="//html/head" position="inside">
                <link href="/website_cart/static/src/css/ordersubmit.css" rel="stylesheet"/>
                <link href="/website_myaccount_base/static/src/css/myaccount.css" rel="stylesheet"/>
                <link href="/website_myaccount_base/static/src/css/wechatcustomer.css" rel="stylesheet"/>
                <link href="/rma/static/src/css/audit.css" rel="stylesheet"/>
                <link href="/rma/static/src/css/after_sales.css" rel="stylesheet"/>
            </xpath>

            <xpath expr="//html/body" position="inside">
                <script type="text/javascript" src="/rma/static/src/js/claimsubmit.js"/>
                <script type="text/javascript" src="/rma/static/src/js/orderlist_scroll_loading.js"/>
                <script type="text/javascript" src="/rma/static/src/js/refresh_page_element.js"/>
                <script type="text/javascript" src="/rma/static/src/js/remove_product.js"/>
                <script type="text/javascript" src="/rma/static/src/js/after_sales.js"/>
            </xpath>
        </template>

        <!-- 售后申请主界面 -->
        <template id="mobile_myaccount_order_after_sale">
            <t t-call="website_myaccount_base.mobile_layout">
                <t t-set="additional_title">我的售后</t>
                <t t-call="rma.mobile_myaccount_order_after_sale_list"/>
            </t>
            <xpath expr="//html/body" position="inside">
                <script type="text/javascript" src="/website_myaccount_base/static/src/js/orderlist_scroll_loading.js"/>
            </xpath>
        </template>
        <template id="mobile_myaccount_order_after_sale_list">
            <t t-if="not flag"><t t-set="flag" t-value="value.get('flag')"/></t>
            <t t-if="not orders">
                <t t-set="orders_dict" t-value="website.get_order_match_for_field(value.get('fields_list'),value.get('limit'),value.get('offset'))"/>
                <t t-set="orders" t-value="orders_dict.get('orders')"/>
            </t>
            <div class="moblie-order-management mobile_after_sale_tag">
                <input type="hidden" name="tmp_orderlist_flag" t-att-value="value.get('flag')" />
                <!-- <t t-call="website_myaccount_base.public_mobile_order_top_menu"/> -->

                <div class="om-choice-status">
                    <t t-call="rma.mobile_myaccount_order_after_sale_list_tab"/>
                </div>

                <div class="mo-order-pd-list om-choice-1 mopl-active after_sale_foreach_tag">
                    <t t-call="website_myaccount_base.public_mobile_foreach_productList"/>
                </div>

                <!-- <t t-call="website_cart.acquirer_list"/> -->

                <!-- 上拉或下拉加载菊花圈,内容加载完后,菊花圈消失 -->
                <t t-call="common_code.public_scroll_calling_loader"/>

            </div>
        </template>
        <template id="mobile_myaccount_order_after_sale_list_tab">
            <t t-if="not flag"><t t-set="flag" t-value="value.get('flag')"/></t>
            <a href="#">
                <div id="om-choice-1" t-att-class="(flag == 'waitting_claim') and 'om-choice om-active' or 'om-choice'">
                    <span>申请售后</span>
                </div>
            </a>
            <a href="#">
                <div id="om-choice-2" t-att-class="(flag == 'already_claimed') and 'om-choice om-active' or 'om-choice'" >
                    <span>进度查询</span>
                </div>
            </a>
            <div class="clear"></div>
        </template>

        <!-- 售后申请详情页 -->
        <template id="mobile_order_activist_service_page">
            <t t-call="website_myaccount_base.mobile_layout">
                <t t-set="additional_title">售后申请服务</t>

                <t t-if="orders and orders.order_line">
                    <div class="shopping-cart-page apply-after-sales">
                        <div class="sc-product-list">
                            <t t-call="rma.mobile_after_sale_product_line" />
                            <p class="end-cart-product" />
                        </div>
                        <div class="service-type">
                            <h4>处理方式</h4>
                            <div class="service-list">
                                <span class="shipping-type sl-active">退货</span>
                                <span class="shipping-type">换货</span>
                                <span class="shipping-type">维修</span>
                            </div>
                        </div>
                        <div class="select-question">
                            <h4>问题类型</h4>
                            <div class="question-list">
                                <p><input type="radio" id="rad1" name="rad[]" checked="checked" value="1111111111111111111111" />1111111111111111111111</p>
                                <p><input type="radio" id="rad2" name="rad[]" value="1222222222222222222222" />1222222222222222222222</p>
                                <p><input type="radio" id="rad3" name="rad[]" value="3333333333333333333333" />3333333333333333333333</p>
                                <p><input type="radio" id="rad4" name="rad[]" value="4444444444444444444444" />4444444444444444444444</p>
                                <p><input type="radio" id="rad5" name="rad[]" value="5555555555555555555555" />5555555555555555555555</p>
                                <p><input type="radio" id="rad6" name="rad[]" value="6666666666666666666666" />6666666666666666666666</p>
                            </div>
                        </div>
                        <div class="question-describe">
                            <h4>问题描述</h4>
                            <p><textarea onfocus="if(value=='请您在此详细描述问题') {value=''}" onblur="if (value=='') {value='请您在此详细描述问题'}">请您在此详细描述问题</textarea></p>
                        </div>

                        <div class="submit-next-button" t-att-data-order_id="orders.id"><a t-att-href="'/m/myaccount/order/after_sale/checkout/%s' % orders.id"><button>下一步</button></a></div>
                    </div>
                </t>
            </t>
        </template>
        <template id="mobile_after_sale_product_line">
            <t t-if="orders">
                <t t-foreach="claims.item_ids" t-as="item">
                    <t t-if="item.is_claim">
                        <table>
                            <tr>
                                <td rowspan="3" class="product-img">
                                    <span t-field="item.product_id.image" t-field-options='{"widget": "image"}'/>
                                </td>
                                <td>
                                    <span t-field="item.product_id.with_context(display_default_code=False).display_name"/>
                                </td>
                                <td><b><a href="#" class="after_sale_delete_line" t-att-data-order_id="orders.id" t-att-data-item-id="item.id">删除</a></b></td>
                            </tr>
                            <tr>
                                <td class="sc-pd-price">
                                    <span t-field="item.product_id.list_price"/>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="input-group oe_website_spinner">
                                        <span class="input-group-addon">
                                            <a t-attf-href="#" class="mb8 js_add_cart_json" data-no-instant="">
                                                <i class="fa fa-minus"></i>
                                            </a>
                                        </span>
                                        <input type="text" class="js_quantity form-control"
                                               t-att-data-line-id="item.id"
                                               t-att-data-product-id="item.product_id.id"
                                               t-att-value="int(item.unclaimed_qty)"/>
                                        <span class="input-group-addon">
                                            <a t-attf-href="#" class="mb8 float_left js_add_cart_json" data-no-instant="">
                                                <i class="fa fa-plus"></i>
                                            </a>
                                        </span>
                                    </div>
                                </td>
                            </tr>
                        </table>
                    </t>
                </t>
            </t>
        </template>

        <!-- 售后申请确认页 -->
        <template id="mobile_after_sale_checkout" name="mobile after sale checkout">
            <t t-call="website_myaccount_base.mobile_layout">
                <t t-set="additional_title">确认售后申请</t>

                <t t-if="not website_sale_address"><t t-set="website_sale_address" t-value="website.sale_get_address()"/></t>
                <t t-if="not website_sale_order"><t t-set="website_sale_order" t-value="website.sale_get_order()"/></t>
                <t t-if="not default_shipto"><t t-set="default_shipto" t-value="website_sale_order and website_sale_order.partner_id.get_default_shipto_obj(website_sale_order.partner_id.id)" /></t>
                <t t-if="website_sale_order and website_sale_order.partner_shipping_id and website_sale_address['shippings']">
                    <t t-if="not using_shipto"><t t-set="using_shipto" t-value="website_sale_order.partner_shipping_id" /></t>
                    <t t-if="not using_address"><t t-set="using_address" t-value="using_shipto.address_id.get_address()"/></t>
                </t>

                <div class="order-submit-page">
                    <div class="os-shipping-info">
                        <p class="shipping-choose">配送方式<span t-att-class="(website_sale_order and website_sale_order.ship_type == 'delivery') and 'shipping-type os-active' or 'shipping-type' " id="os-st-1"  t-att-data-ship-type="'delivery'">上门取货</span>
                        <span  t-att-class="(website_sale_order and website_sale_order.ship_type == 'pickup') and 'shipping-type os-active' or 'shipping-type' " id="os-st-2" t-att-data-ship-type="'pickup'">邮寄到商家</span></p>
                        <p class="address-change">
                            <t t-call="website_cart.checkout_using_shipto"/>
                        </p>
                    </div>
                    <div class="os-shopping-cart">
                        <p><b class="glyphicon glyphicon-list-alt"></b>退货商品</p>

                        <t t-foreach="claims.item_ids" t-as="item">
                            <a class="product-images" title="" t-attf-href="/shop/product/#{ slug(item.product_id.product_tmpl_id) }">
                                <table>
                                    <tr>
                                        <td rowspan="3" class="product-img"><span t-field="item.product_id.image" t-field-options='{"widget": "image"}'/></td>
                                        <td><span t-esc="item.product_id.name"/></td>
                                    </tr>
                                    <tr>
                                        <td><span t-esc="item.product_id.with_context(display_default_code=False).display_name"/>/数量<span t-esc="int(item.product_uom_qty)"/></td>
                                    </tr>
                                    <tr>
                                        <td class="product-price"><span t-field="item.product_id.list_price"/></td>
                                    </tr>
                                </table>
                            </a>
                        </t>
                        <p class="clear"></p>
                    </div>
                    <div class="os-payment-type">
                        <p>处理方式<span class="os-py-detail" t-esc="claims.deal_method"></span></p>
                    </div>
                    <div class="os-payment-type">
                        <p>问题类型<span class="os-py-detail" t-esc="claims.claim_origin"></span></p>
                    </div>
                    <div class="os-payment-type">
                        <p>问题描述<span class="os-py-detail" t-esc="claims.description"></span></p>
                    </div>
                    <div class="os-submit-orders">
                        <p>
                            <span class="submit-claim-orders-button">
                                <a t-att-href="'/m/myaccount/order/after_sale/claim_create/%s' % orders.id">
                                    <button>提交</button>
                                </a>
                            </span>
                        </p>
                        <p class="clear"></p>
                    </div>
                </div>
                <div id="shclDefault"></div>
            </t>
        </template>

        <!-- 售后申请完成页 -->
        <template id="mobile_after_sale_created" name="mobile after sale created">
            <t t-call="website_myaccount_base.mobile_layout">
                <div class="submit-successful">
                    <div class="ss-img"><img src="/rma/static/src/images/submits-s.png" /></div>
                    <div class="ss-title">售后服务单申请成功</div>
                    <div class="ss-detail">
                        <p>申请时间: <span t-esc="claims.date"/></p>
                        <p>申请类型: <span t-esc="claims.name"/></p>
                    </div>
                    <div class="ss-button">
                        <a href="#"><p>进度查询</p></a><a href="#"><p>售后首页</p></a>
                    </div>
                </div>
            </t>
        </template>

        <!-- 售后进度查询页 -->
        <template id="mobile_after_sale_schedule_view">
            <t t-call="website_myaccount_base.mobile_layout">
                <t t-if="claims">
                    <t t-foreach="claims.item_ids" t-as="item">
                        
                    </t>
                </t>
            </t>
        </template>
        <template id="mobile_after_sale_detail_view">
            <t t-call="website_myaccount_base.mobile_layout">
                <t t-if="claims">
                    <t t-foreach="claims.item_ids" t-as="item">
                        
                    </t>
                </t>
            </t>
        </template>
    </data>
</openerp>